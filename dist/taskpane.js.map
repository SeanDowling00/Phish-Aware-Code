{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html","webpack://office-addin-taskpane-js/./node_modules/html-loader/dist/runtime/getUrl.js","webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/compat get default export","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Phishing Tool</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please sideload your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <button id=\\\"run\\\"> Run Scans </button> <button id=\\\"analyseHeaders\\\"> Header Information</button> <button id=\\\"analyseURLs\\\"> URLs </button> <button id=\\\"analyseAttachments\\\"> Attachments </button> <button id=\\\"forward-email\\\"> Report </button> <label id=\\\"item-results\\\" class=\\\"result\\\"></label> <label id=\\\"item-fraudInfo\\\"></label> <label id=\\\"item-proceed\\\"></label> <label id=\\\"item-to\\\"></label> <label id=\\\"item-sender\\\"></label> <label id=\\\"item-return\\\"></label> <label id=\\\"item-date\\\"></label> <label id=\\\"item-subject\\\"></label> <label id=\\\"item-spf\\\"></label> <label id=\\\"item-dmarc\\\"></label> <label id=\\\"item-dkim\\\"></label> <label id=\\\"item-attachment\\\"></label> <label id=\\\"item-attachmentresults\\\"><iframe id=\\\"item-attachmentresults\\\" src=\\\"https://attachment-api.azurewebsites.net\\\" width=\\\"61.5%\\\" height=\\\"500px\\\"></iframe></label> <label id=\\\"item-info\\\"></label> <label id=\\\"item-links\\\"></label> <label id=\\\"item-vtlinksresponse\\\"></label> <label id=\\\"item-cplinksresponse\\\"></label> <button id=\\\"spf-button\\\">SPF</button> <button id=\\\"dkim-button\\\">DKIM</button> <button id=\\\"dmarc-button\\\">DMARC</button> <div id=\\\"info-container\\\"></div> <div id=\\\"run-info\\\"> <h1>Phish Detection</h1> <p>Click the button below to scan:</p> <li>Header Information.</li> <li>URLs.</li> <li>Attachments.</li> </div> <button id=\\\"showmore\\\"> Show More</button> </main> </body> </html> <\" + \"script>const spfButton=document.getElementById(\\\"spf-button\\\"),dkimButton=document.getElementById(\\\"dkim-button\\\"),dmarcButton=document.getElementById(\\\"dmarc-button\\\"),infoContainer=document.getElementById(\\\"info-container\\\");spfButton.addEventListener(\\\"click\\\",(function(){infoContainer.innerHTML=\\\"Sender Policy Framework (SPF) is an email authentication method designed to detect forging sender addresses during the delivery of the email. It allows the person receiving the email to check that it was sent by an authorized server, preventing spammers from sending messages with forged From addresses.\\\"})),dkimButton.addEventListener(\\\"click\\\",(function(){infoContainer.innerHTML=\\\"DomainKeys Identified Mail (DKIM) is an email authentication method. It allows the person receiving the email to check that it was indeed sent by the domain it claims to be sent from, and that it hasn't been modified during transport.\\\"})),dmarcButton.addEventListener(\\\"click\\\",(function(){infoContainer.innerHTML=\\\"Domain-based Message Authentication, Reporting & Conformance (DMARC) is an email-validation system designed to give email domain owners the ability to protect their domain from unauthorized use, known as email spoofing. DMARC allows a domain owner to publish a policy on their domain that specifies which mechanism(s) (e.g. SPF, DKIM) are used to authenticate email messages sent from their domain.\\\"})),document.getElementById(\\\"showmore\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-to\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-return\\\").style.display=\\\"none\\\",document.getElementById(\\\"run-info\\\").style.display=\\\"block\\\",document.getElementById(\\\"forward-email\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-results\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-fraudInfo\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-proceed\\\").style.display=\\\"none\\\",document.getElementById(\\\"info-container\\\").style.display=\\\"none\\\",document.getElementById(\\\"showmore\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-sender\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-date\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-subject\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-spf\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dkim\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dmarc\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachment\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"analyseHeaders\\\").style.display=\\\"none\\\",document.getElementById(\\\"analyseURLs\\\").style.display=\\\"none\\\",document.getElementById(\\\"analyseAttachments\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachmentresults\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-links\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-cplinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-vtlinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"run\\\").addEventListener(\\\"click\\\",(function(){document.getElementById(\\\"run-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"run\\\").style.display=\\\"none\\\",document.getElementById(\\\"analyseHeaders\\\").style.display=\\\"block\\\",document.getElementById(\\\"analyseURLs\\\").style.display=\\\"block\\\",document.getElementById(\\\"analyseAttachments\\\").style.display=\\\"block\\\",document.getElementById(\\\"forward-email\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-to\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-return\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-results\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-fraudInfo\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-proceed\\\").style.display=\\\"none\\\",document.getElementById(\\\"showmore\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-sender\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-date\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-subject\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-spf\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dkim\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dmarc\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachment\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"info-container\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachmentresults\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-links\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-cplinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-vtlinksresponse\\\").style.display=\\\"none\\\"})),document.getElementById(\\\"analyseHeaders\\\").addEventListener(\\\"click\\\",(function(){document.getElementById(\\\"run-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-results\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-fraudInfo\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-proceed\\\").style.display=\\\"block\\\",document.getElementById(\\\"info-container\\\").style.display=\\\"none\\\",document.getElementById(\\\"showmore\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-to\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-return\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-sender\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-date\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-subject\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-spf\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dkim\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dmarc\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachment\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachmentresults\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-links\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-cplinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-vtlinksresponse\\\").style.display=\\\"none\\\"})),document.getElementById(\\\"showmore\\\").addEventListener(\\\"click\\\",(function(){document.getElementById(\\\"item-to\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-return\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-sender\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-date\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-subject\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-spf\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-dkim\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-dmarc\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-info\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-attachment\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"block\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"block\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"block\\\",document.getElementById(\\\"info-container\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-url\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachmentresults\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-links\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-vtlinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-cplinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"showmore\\\").style.display=\\\"none\\\"})),document.getElementById(\\\"analyseURLs\\\").addEventListener(\\\"click\\\",(function(){document.getElementById(\\\"run-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-results\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-to\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-return\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-fraudInfo\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-proceed\\\").style.display=\\\"none\\\",document.getElementById(\\\"info-container\\\").style.display=\\\"none\\\",document.getElementById(\\\"showmore\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-sender\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-date\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-subject\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-spf\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dkim\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dmarc\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachment\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachmentresults\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-links\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-vtlinksresponse\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-cplinksresponse\\\").style.display=\\\"none\\\"})),document.getElementById(\\\"analyseAttachments\\\").addEventListener(\\\"click\\\",(function(){document.getElementById(\\\"run-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-results\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-to\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-return\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-fraudInfo\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-proceed\\\").style.display=\\\"none\\\",document.getElementById(\\\"info-container\\\").style.display=\\\"none\\\",document.getElementById(\\\"showmore\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-sender\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-date\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-subject\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-spf\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dkim\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-dmarc\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-info\\\").style.display=\\\"none\\\",document.getElementById(\\\"spf-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dmarc-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"dkim-button\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-links\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-attachment\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-attachmentresults\\\").style.display=\\\"block\\\",document.getElementById(\\\"item-vtlinksresponse\\\").style.display=\\\"none\\\",document.getElementById(\\\"item-cplinksresponse\\\").style.display=\\\"none\\\"}))<\" + \"/script> \";\n// Exports\nexport default code;","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n\n  if (!url) {\n    return url;\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = String(url.__esModule ? url.default : url);\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n\n  return url;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t41: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","Office.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"run\").onclick = run;\n  }\n});\n\nfunction getParameterByName(url, name) {\n  name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n  var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n    results = regex.exec(url);\n  if (!results) return null;\n  if (!results[2]) return \"\";\n  return results[2].replace(/\\+/g, \" \");\n}\n\nexport async function run() {\n  const item = Office.context.mailbox.item;\n  const attachments = item.attachments;\n\n  Office.context.mailbox.item.getAllInternetHeadersAsync(function (result) {\n    if (result.status === \"succeeded\") {\n      var spf = result.value.match(/spf=([^;\\s]+)/g);\n      if (spf) {\n        spf = spf[0].substring(4);\n      } else {\n        spf = \"Not Found\";\n      }\n\n      var dkim = result.value.match(/dkim=([^;\\s]+)/g);\n      if (dkim) {\n        dkim = dkim[0].substring(5);\n      } else {\n        dkim = \"Not Found\";\n      }\n\n      var dmarc = result.value.match(/dmarc=([^;\\s]+)/g);\n      if (dmarc) {\n        dmarc = dmarc[0].substring(6);\n      } else {\n        dmarc = \"Not Found\";\n      }\n\n      var internetHeaders = result.value.split(/\\r\\n/);\n      for (var i = 0; i < internetHeaders.length; i++) {\n        console.log(internetHeaders[i]);\n      }\n\n      var toList = item.to;\n      var emailList = toList.map(function (to) {\n        return to.emailAddress;\n      });\n\n      var returnPath = result.value.match(/Return-Path:\\s*([^;\\s]+)/i);\n      if (returnPath) {\n        returnPath = returnPath[1];\n      } else {\n        returnPath = \"Not Found\";\n      }\n\n      document.getElementById(\"item-results\").classList.remove(\"fraud\");\n      document.getElementById(\"item-results\").classList.remove(\"authentic\");\n\n      if (\n        spf === \"Not Found\" ||\n        dkim === \"Not Found\" ||\n        dmarc === \"Not Found\" ||\n        spf === \"fail\" ||\n        dkim === \"fail\" ||\n        dmarc === \"fail\"\n      ) {\n        var results = \"Potentially Fraudulent\";\n        document.getElementById(\"item-results\").classList.add(\"fraud\");\n        var fraudInfo =\n          \"This email may be fraudulant, this is either because <br/> A) The analysis returned failed results <br/> B) The checks could not be complete\";\n        document.getElementById(\"item-fraudInfo\").classList.add(\"fraud\");\n        var proceed =\n          \"This analysis does not mean this email is 100% fraudulant or authentic, spoofing attacks can still occur!!\";\n        document.getElementById(\"item-proceed\").classList.add(\"fraud\");\n      } else {\n        var results = \"Authentic Email\";\n        document.getElementById(\"item-results\").classList.add(\"authentic\");\n        var fraudInfo =\n          \"This is more than likely an authentic Email, this means the email may <br/> A) Not be Spoofed <br/> B) Not be a Phishing Email\";\n        document.getElementById(\"item-fraudInfo\").classList.add(\"authentic\");\n        var proceed =\n          \"This analysis does not mean this email is 100% fraudulant or authentic, spoofing attacks can still occur!\";\n        document.getElementById(\"item-proceed\").classList.add(\"fraud\");\n      }\n      var info = \"Click each button below for more information\";\n\n      document.getElementById(\"item-results\").innerHTML = results;\n      document.getElementById(\"item-fraudInfo\").innerHTML = fraudInfo;\n      document.getElementById(\"item-proceed\").innerHTML = proceed;\n      document.getElementById(\"item-subject\").innerHTML = \"<b>Subject:</b> <br/>\" + item.subject;\n      document.getElementById(\"item-to\").innerHTML = \"<b>To:</b> <br/>\" + emailList.join(\", \");\n      document.getElementById(\"item-sender\").innerHTML =\n        \"<b>Sender: </b></br>(Should match with 'Return Path') <br/>\" + item.sender.emailAddress;\n      document.getElementById(\"item-return\").innerHTML = \"<b>Return Path:</b> <br/>\" + returnPath;\n      document.getElementById(\"item-date\").innerHTML = \"<b>Received:</b> <br/>\" + item.dateTimeCreated;\n      document.getElementById(\"item-dkim\").innerHTML = \"<b>DKIM:</b> <br/>\" + dkim;\n      document.getElementById(\"item-spf\").innerHTML = \"<b>SPF:</b> <br/>\" + spf;\n      document.getElementById(\"item-dmarc\").innerHTML = \"<b>DMARC:</b> <br/> \" + dmarc;\n      document.getElementById(\"item-info\").innerHTML = info;\n    } else {\n      console.error(`Error getting internet headers: ${result.error.message}`);\n    }\n  });\n\n  Office.context.mailbox.item.body.getAsync(\"text\", function (result) {\n    var urls = Office.context.mailbox.item.getEntities().urls;\n    var filteredUrls = [];\n    var scannedUrls = [];\n    var newUrls = [];\n    var excludedUrls = [];\n    for (var i = 0; i < urls.length; i++) {\n      var url = urls[i];\n      if (url.includes(\"eur03.safelinks.protection.outlook.com\")) {\n        var decodedUrl = decodeURIComponent(getParameterByName(url, \"url\"));\n        url = decodedUrl;\n      }\n      if (!url.includes(\"setu\") && !url.includes(\"mailto\")) {\n        if (\n          !url.includes(\"facebook.com\") &&\n          !url.includes(\"instagram.com\") &&\n          !url.includes(\"twitter.com\") &&\n          !url.includes(\"youtube.com\") &&\n          !url.includes(\"tiktok.com\") &&\n          !url.includes(\"google.com\") &&\n          !url.includes(\"itcsu.ie\")\n        ) {\n          if (!url.includes(\"bit.ly\")) {\n            var filteredUrl = url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?([^\\/]+)\\/?.*$/, \"$1\");\n            if (filteredUrls.indexOf(filteredUrl) < 0) {\n              // Check if URL already exists in array\n              filteredUrls.push(filteredUrl);\n              var newUrl = `https://api-phish-proxy.azurewebsites.net/scan?url=${encodeURIComponent(filteredUrl)}`;\n              newUrls.push(newUrl);\n            }\n          } else {\n            // Append message to user if bit.ly link is found\n            document.getElementById(\"item-links\").innerHTML +=\n              \"<b>A 'bit.ly' URL was found, these need to manually scanned on <a href=https://www.virustotal.com/gui/home/search>Virustotal</a> or <a href=https://urlscan.io/>URL Scan</a><br><br>\";\n          }\n        } else {\n          var excludedUrl = url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?([^\\/]+)\\/?.*$/, \"$1\");\n          excludedUrls.push(excludedUrl); // Add excluded URLs to the new array\n        }\n      }\n    }\n\n    if (urls.length == 0) {\n      document.getElementById(\"item-links\").innerHTML = \"No URLs found\";\n      document.getElementById(\"item-vtlinksresponse\").innerHTML = \"Please continue your analysis\";\n    }\n\n    if (filteredUrls.length > 0) {\n      document.getElementById(\"item-links\").innerHTML += \"Domains found in this email: <br><ul>\";\n      for (var i = 0; i < filteredUrls.length; i++) {\n        document.getElementById(\"item-links\").innerHTML += \"<li>\" + filteredUrls[i] + \"</li>\";\n      }\n      document.getElementById(\"item-links\").innerHTML += \"</ul>\";\n    }\n    if (excludedUrls.length > 0) {\n      document.getElementById(\"item-links\").innerHTML +=\n        \"<br>Large corporation domains will not be scanned by API Scanners, that being said, below is a list of domains that were not scanned:<br><ul>\";\n      for (var i = 0; i < excludedUrls.length; i++) {\n        document.getElementById(\"item-links\").innerHTML += \"<li>\" + excludedUrls[i] + \"</li>\";\n      }\n      document.getElementById(\"item-links\").innerHTML += \"</ul>\";\n    }\n\n    var responseContainer = document.createElement(\"div\");\n    document.body.appendChild(responseContainer);\n\n    for (var i = 0; i < filteredUrls.length; i++) {\n      if (scannedUrls.indexOf(filteredUrls[i]) === -1) {\n        scannedUrls.push(filteredUrls[i]);\n        (function (url) {\n          var xhr = new XMLHttpRequest();\n          var apiUrl = `https://api-phish-proxy.azurewebsites.net/scan?url=${encodeURIComponent(url)}`;\n          xhr.open(\"GET\", apiUrl, true);\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n          xhr.setRequestHeader(\"Access-Control-Allow-Origin\", \"*\");\n          xhr.setRequestHeader(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n          xhr.onreadystatechange = function () {\n            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n              var responseDiv = document.createElement(\"div\");\n              responseDiv.innerHTML = `<div style=\"text-align: center;\">\n          <p><h3><b><u>URL:<br></b></u> ${url}</h3></p>\n          </div> <b>${this.responseText}</b>`;\n              document.getElementById(\"item-vtlinksresponse\").appendChild(responseDiv);\n            } else if (this.readyState === XMLHttpRequest.DONE) {\n              console.error(`Request failed with status: ${this.status}`);\n              var responseDiv = document.createElement(\"div\");\n              responseDiv.innerHTML = `Error for ${url}: This URL could not be scanned for some reason, please retry or go to <a href=https://api-phish-proxy.azurewebsites.net/scan?url= target=\"_blank\">Here</a> and copy the link you want scanned and paste it to the end of the URL, if this method still does not work, please go <a href=https://www.virustotal.com/gui/home/search>Virustotal</a> or <a href=https://urlscan.io/>URL Scan</a> and copy the link to be scanned`;\n              document.getElementById(\"item-vtlinksresponse\").appendChild(responseDiv);\n            }\n          };\n          xhr.send();\n        })(filteredUrls[i]);\n      }\n    }\n  });\n\n  let attachmentInfo = \"\";\n  if (attachments.length === 0) {\n    attachmentInfo = \"No attachments found.\";\n  } else {\n    attachmentInfo = \"<ul>\";\n    for (let i = 0; i < attachments.length; i++) {\n      const attachment = attachments[i];\n      let contentType = attachment.contentType;\n      if (contentType.startsWith(\"image/\")) {\n        if (contentType === \"image/jpeg\") {\n          contentType = \"JPEG image\";\n        } else if (contentType === \"image/png\") {\n          contentType = \"PNG image\";\n        } else if (contentType === \"image/gif\") {\n          contentType = \"GIF image\";\n        } else {\n          contentType = \"Image\";\n        }\n      } else if (contentType.includes(\"pdf\")) {\n        contentType = \"PDF document\";\n      } else if (contentType.startsWith(\"audio/\")) {\n        contentType = \"Audio file\";\n      } else if (contentType === \"video/mp4\") {\n        contentType = \"MP4 video\";\n      } else if (contentType.startsWith(\"application/vnd.openxmlformats-officedocument.\")) {\n        if (contentType === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\") {\n          contentType = \"Microsoft Word document\";\n        } else if (contentType === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\") {\n          contentType = \"Microsoft Excel spreadsheet\";\n        } else {\n          contentType = \"Office document\";\n        }\n      } else {\n        contentType = attachment.contentType;\n      }\n      attachmentInfo += `<li><strong>Name:</strong> ${attachment.name} </li>\n                         <li><strong>Size:</strong> ${attachment.size} Bytes</li>\n                         <li><strong>Content Type:</strong> ${contentType}</li>`;\n      attachmentInfo += \"\";\n    }\n    attachmentInfo += \"</ul>\";\n  }\n\n  document.getElementById(\"item-attachment\").innerHTML = attachmentInfo;\n\n  async function forwardEmail() {\n    const item = Office.context.mailbox.item;\n    var urls = Office.context.mailbox.item.getEntities().urls;\n\n    var filteredUrls = [];\n\n    var scannedUrls = [];\n    var newUrls = [];\n\n    for (var i = 0; i < urls.length; i++) {\n      var url = urls[i];\n      if (url.includes(\"eur03.safelinks.protection.outlook.com\")) {\n        var decodedUrl = decodeURIComponent(getParameterByName(url, \"url\"));\n        url = decodedUrl;\n      }\n      if (!url.includes(\"setu\") && !url.includes(\"mailto\")) {\n        var filteredUrl = url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?([^\\/]+)\\/?.*$/, \"$1\");\n        filteredUrls.push(filteredUrl);\n        var newUrl = `https://api-phish-proxy.azurewebsites.net/scan?url=${encodeURIComponent(filteredUrl)}`;\n        newUrls.push(newUrl);\n      }\n    }\n    // Get email properties\n    const subject = item.subject;\n    const sender = item.sender.emailAddress;\n    const received = item.dateTimeCreated.toLocaleString();\n    const body = await new Promise((resolve, reject) => {\n      item.body.getAsync(Office.CoercionType.Html, {}, (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value);\n        } else {\n          reject(result.error);\n        }\n      });\n    });\n    const to = JSON.stringify(item.to);\n\n    for (var i = 0; i < newUrls.length; i++) {\n      var link = document.createElement(\"a\");\n      link.href = newUrls[i];\n      link.target = \"_blank\";\n      link.innerText = newUrls[i];\n      // document.body.appendChild(link);\n    }\n\n    Office.context.mailbox.item.getAllInternetHeadersAsync(function (result) {\n      if (result.status === \"succeeded\") {\n        var spf = result.value.match(/spf=([^;\\s]+)/g);\n        if (spf) {\n          spf = spf[0].substring(4);\n        } else {\n          spf = \"Not Found\";\n        }\n\n        var dkim = result.value.match(/dkim=([^;\\s]+)/g);\n        if (dkim) {\n          dkim = dkim[0].substring(5);\n        } else {\n          dkim = \"Not Found\";\n        }\n\n        var dmarc = result.value.match(/dmarc=([^;\\s]+)/g);\n        if (dmarc) {\n          dmarc = dmarc[0].substring(6);\n        } else {\n          dmarc = \"Not Found\";\n        }\n\n        var internetHeaders = result.value.split(/\\r\\n/);\n        for (var i = 0; i < internetHeaders.length; i++) {\n          console.log(internetHeaders[i]);\n        }\n\n        var toList = item.to;\n        var emailList = toList.map(function (to) {\n          return to.emailAddress;\n        });\n\n        var returnPath = result.value.match(/Return-Path:\\s*([^;\\s]+)/i);\n        if (returnPath) {\n          returnPath = returnPath[1];\n        } else {\n          returnPath = \"Not Found\";\n        }\n\n        // Format the email body\n        const emailBody = `\n      <strong>The email below was determined to be a phishing email by the user, please review and take appropriate actions</strong><br>\n      <br>\n      <hr>\n      <br>\n      <strong>To:</strong> ${emailList.join(\", \")}<br>\n      <strong>Sender:</strong> ${sender}<br>\n      <strong>Return Path:</strong> ${returnPath}<br>\n      <strong>Received:</strong> ${received}<br>\n      <strong>Subject:</strong> ${subject}<br>\n      <strong>SPF:</strong> ${spf}<br>\n      <strong>DMARC:</strong> ${dmarc}<br>\n      <strong>DKIM:</strong> ${dkim}<br>\n      <br>\n      <hr>\n      <br>\n      <strong>Scanned URLs:</strong>\n      <br>\n      ${newUrls.map((url) => `<a href=\"${url}\" target=\"_blank\">${url}</a><br>`).join(\"\")}\n      <br>\n      <hr>\n      <br>\n      <strong><a href=\"https://attachment-api.azurewebsites.net\">Scan Attachments Here</a></strong>\n      <br>\n      <br>\n      <hr>\n      <br>\n      <strong><u>Email Body</u></strong><br>\n      <br>\n      ${body}\n      <br>\n      <hr>\n      <br>\n      <strong><u>Internet Headers</u></strong><br>\n      <br>\n      <pre>${result.value}</pre>\n      <br>\n      <hr>\n    `;\n\n        // Create the new message and set the recipients and subject\n        const message = Office.context.mailbox.displayNewMessageForm({\n          toRecipients: [\"sean.dowling185@gmail.com\"],\n          subject: `PHISHING ATTEMPT: (${subject})`,\n          htmlBody: `${emailBody}`,\n        });\n      }\n      Office.context.ui.displayDialogAsync(\n        \"https://phishdetectionandguidance.azurewebsites.net/assets/notification.html\",\n        { height: 30, width: 20 },\n        (result) => {\n          if (result.status === \"succeeded\") {\n            const dialog = result.value;\n            dialog.addEventHandler(Office.EventType.DialogMessageReceived, (event) => {\n              dialog.close();\n            });\n          }\n        }\n      );\n    });\n  }\n  document.getElementById(\"forward-email\").onclick = forwardEmail;\n}\n"],"names":["___HTML_LOADER_IMPORT_0___","module","exports","url","options","String","__esModule","default","hash","maybeNeedQuotes","test","concat","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","Op","hasOwn","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","configurable","writable","err","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","done","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","getParameterByName","results","RegExp","exec","run","_run","_callee2","item","attachments","attachmentInfo","attachment","contentType","forwardEmail","_forwardEmail","_context2","_callee","urls","filteredUrls","newUrls","decodedUrl","filteredUrl","newUrl","subject","sender","received","body","link","_context","Office","mailbox","getEntities","includes","decodeURIComponent","encodeURIComponent","emailAddress","dateTimeCreated","toLocaleString","getAsync","CoercionType","Html","status","AsyncResultStatus","Succeeded","JSON","stringify","to","createElement","target","innerText","getAllInternetHeadersAsync","spf","match","substring","dkim","dmarc","internetHeaders","split","console","log","emailList","map","returnPath","emailBody","join","displayNewMessageForm","toRecipients","htmlBody","ui","displayDialogAsync","height","width","dialog","addEventHandler","EventType","DialogMessageReceived","event","close","getElementById","classList","remove","add","fraudInfo","proceed","innerHTML","message","scannedUrls","excludedUrls","excludedUrl","indexOf","responseContainer","appendChild","xhr","XMLHttpRequest","apiUrl","open","setRequestHeader","onreadystatechange","readyState","DONE","responseDiv","responseText","send","startsWith","size","onclick","onReady","host","HostType","Outlook","style","display","URL"],"sourceRoot":""}