{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/./src/commands/commands.js","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","Office.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"run\").onclick = run;\n  }\n});\nfunction loadWebPage(url, elementId) {\n  const xhr = new XMLHttpRequest();\n  xhr.onreadystatechange = function () {\n    if (this.readyState === 4 && this.status === 200) {\n      document.getElementById(elementId).innerHTML = xhr.responseText;\n    }\n  };\n  xhr.open(\"GET\", url, true);\n  xhr.send();\n}\n\nfunction getParameterByName(url, name) {\n  name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n  var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n    results = regex.exec(url);\n  if (!results) return null;\n  if (!results[2]) return \"\";\n  return results[2].replace(/\\+/g, \" \");\n}\n\nexport async function run() {\n  const item = Office.context.mailbox.item;\n\n  // Get the attachments collection\n  const attachments = item.attachments;\n\n  Office.context.mailbox.item.getAllInternetHeadersAsync(function (result) {\n    if (result.status === \"succeeded\") {\n      var spf = result.value.match(/spf=([^;\\s]+)/g);\n      if (spf) {\n        spf = spf[0].substring(4);\n      } else {\n        spf = \"Not Found\";\n      }\n      var dkim = result.value.match(/dkim=([^;\\s]+)/g);\n      if (dkim) {\n        dkim = dkim[0].substring(5);\n      } else {\n        dkim = \"Not Found\";\n      }\n      var dmarc = result.value.match(/dmarc=([^;\\s]+)/g);\n      if (dmarc) {\n        dmarc = dmarc[0].substring(6);\n      } else {\n        dmarc = \"Not Found\";\n      }\n\n      document.getElementById(\"item-results\").classList.remove(\"fraud\");\n      document.getElementById(\"item-results\").classList.remove(\"authentic\");\n\n      if (\n        spf === \"Not Found\" ||\n        dkim === \"Not Found\" ||\n        dmarc === \"Not Found\" ||\n        spf === \"none\" ||\n        dkim === \"none\" ||\n        dmarc === \"none\" ||\n        spf === \"fail\" ||\n        dkim === \"fail\" ||\n        dmarc === \"fail\"\n      ) {\n        var results = \"Potentially Fraudulent\";\n        document.getElementById(\"item-results\").classList.add(\"fraud\");\n        var fraudInfo =\n          \"This email may be fraudulant, this is either because <br/> A) The analysis returned failed results <br/> B) The checks could not be complete\";\n        document.getElementById(\"item-fraudInfo\").classList.add(\"fraud\");\n        var proceed =\n          \"This analysis does not mean this email is 100% fraudulant or authentic, spoofing attacks can still occur!!\";\n        document.getElementById(\"item-proceed\").classList.add(\"fraud\");\n      } else {\n        var results = \"Authentic Email\";\n        document.getElementById(\"item-results\").classList.add(\"authentic\");\n        var fraudInfo =\n          \"This is more than likely an authentic Email, this means the email may <br/> A) Not be Spoofed <br/> B) Not be a Phishing Email\";\n        document.getElementById(\"item-fraudInfo\").classList.add(\"authentic\");\n        var proceed =\n          \"This analysis does not mean this email is 100% fraudulant or authentic, spoofing attacks can still occur!\";\n        document.getElementById(\"item-proceed\").classList.add(\"fraud\");\n      }\n      var info = \"Click each button below for more information\";\n\n      document.getElementById(\"item-results\").innerHTML = results;\n      document.getElementById(\"item-fraudInfo\").innerHTML = fraudInfo;\n      document.getElementById(\"item-proceed\").innerHTML = proceed;\n      document.getElementById(\"item-subject\").innerHTML = \"<b>Subject:</b> <br/>\" + item.subject;\n      document.getElementById(\"item-sender\").innerHTML = \"<b>Sender:</b> <br/>\" + item.sender.emailAddress;\n      document.getElementById(\"item-date\").innerHTML = \"<b>Received:</b> <br/>\" + item.dateTimeCreated;\n      document.getElementById(\"item-dkim\").innerHTML = \"<b>DKIM:</b> <br/>\" + dkim;\n      document.getElementById(\"item-spf\").innerHTML = \"<b>SPF:</b> <br/>\" + spf;\n      document.getElementById(\"item-dmarc\").innerHTML = \"<b>DMARC:</b> <br/> \" + dmarc;\n      document.getElementById(\"item-info\").innerHTML = info;\n    } else {\n      console.error(`Error getting internet headers: ${result.error.message}`);\n    }\n  });\n\n  Office.context.mailbox.item.body.getAsync(\"text\", function (result) {\n    var urls = Office.context.mailbox.item.getEntities().urls;\n\n    var filteredUrls = [];\n\n    for (var i = 0; i < urls.length; i++) {\n      var url = urls[i];\n      if (url.includes(\"eur03.safelinks.protection.outlook.com\")) {\n        var decodedUrl = decodeURIComponent(getParameterByName(url, \"url\"));\n        url = decodedUrl;\n      }\n      if (!url.includes(\"setu\") && !url.includes(\"mailto\")) {\n        filteredUrls.push(url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?([^\\/]+)\\/?.*$/, \"$1\"));\n      }\n    }\n\n    document.getElementById(\"item-links\").innerHTML = \"URLs found in this email: \" + filteredUrls;\n    // Create a parent div element to contain all the responses\n    var responseContainer = document.createElement(\"div\");\n    document.body.appendChild(responseContainer);\n\n    var scannedUrls = [];\n\n    for (var i = 0; i < filteredUrls.length; i++) {\n      if (scannedUrls.indexOf(filteredUrls[i]) === -1) {\n        scannedUrls.push(filteredUrls[i]); // add scanned URL to the array\n        (function (url) {\n          // create closure around url variable\n          var xhr = new XMLHttpRequest();\n          var apiUrl = `https://api-phish-proxy.azurewebsites.net/scan?url=${encodeURIComponent(url)}`;\n          xhr.open(\"GET\", apiUrl, true);\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n          xhr.setRequestHeader(\"Access-Control-Allow-Origin\", \"*\");\n          xhr.setRequestHeader(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n          xhr.onreadystatechange = function () {\n            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n              var responseDiv = document.createElement(\"div\");\n              responseDiv.innerHTML = `<u><b>${url}</b>: <b>${this.responseText}</b>`;\n              document.getElementById(\"item-vtlinksresponse\").appendChild(responseDiv);\n            } else if (this.readyState === XMLHttpRequest.DONE) {\n              console.error(`Request failed with status: ${this.status}`);\n              var responseDiv = document.createElement(\"div\");\n              responseDiv.innerHTML = `Error for ${url}: Request failed with status: ${this.status}`;\n              document.getElementById(\"item-vtlinksresponse\").appendChild(responseDiv);\n            }\n          };\n          xhr.send();\n        })(filteredUrls[i]); // pass url variable into closure function\n      }\n    }\n  });\n\n  let attachmentInfo = \"\";\n  if (attachments.length === 0) {\n    attachmentInfo = \"No attachments found.\";\n  } else {\n    attachmentInfo = \"<ul>\";\n    for (let i = 0; i < attachments.length; i++) {\n      const attachment = attachments[i];\n      let contentType = attachment.contentType;\n      if (contentType.startsWith(\"image/\")) {\n        if (contentType === \"image/jpeg\") {\n          contentType = \"JPEG image\";\n        } else if (contentType === \"image/png\") {\n          contentType = \"PNG image\";\n        } else if (contentType === \"image/gif\") {\n          contentType = \"GIF image\";\n        } else {\n          contentType = \"Image\";\n        }\n      } else if (contentType.includes(\"pdf\")) {\n        contentType = \"PDF document\";\n      } else if (contentType.startsWith(\"audio/\")) {\n        contentType = \"Audio file\";\n      } else if (contentType === \"video/mp4\") {\n        contentType = \"MP4 video\";\n      } else if (contentType.startsWith(\"application/vnd.openxmlformats-officedocument.\")) {\n        if (contentType === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\") {\n          contentType = \"Microsoft Word document\";\n        } else if (contentType === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\") {\n          contentType = \"Microsoft Excel spreadsheet\";\n        } else {\n          contentType = \"Office document\";\n        }\n      } else {\n        contentType = attachment.contentType;\n      }\n      attachmentInfo += `<li><strong>Name:</strong> ${attachment.name} <br>\n                         <strong>Size:</strong> ${attachment.size} Bytes<br>\n                         <strong>Content Type:</strong> ${contentType}</li>`;\n      attachmentInfo += \"<br>\";\n    }\n    attachmentInfo += \"</ul>\";\n  }\n\n  document.getElementById(\"item-attachment\").innerHTML = attachmentInfo;\n  //    var link = \"<a href='https://attachment-api.azurewebsites.net/'>Click Here</a>\";\n  // document.getElementById(\"item-attachmentresults\").innerHTML = \"To scan any file, \" + link + \" and then drag and drop the file to be scanned onto the upload button\";\n\n  // Call the function to load the webpage and insert it into an HTML element with an ID of \"myDiv\"\n  loadWebPage(\"https://attachment-api.azurewebsites.net/\", \"item-attachmentresults\");\n}\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["__webpack_require__","_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","loadWebPage","url","elementId","xhr","XMLHttpRequest","onreadystatechange","this","readyState","status","document","getElementById","innerHTML","responseText","open","send","getParameterByName","replace","results","RegExp","exec","run","_run","apply","arguments","_callee","item","attachments","attachmentInfo","attachment","contentType","_context","Office","mailbox","getAllInternetHeadersAsync","spf","match","substring","dkim","dmarc","classList","remove","add","fraudInfo","proceed","subject","sender","emailAddress","dateTimeCreated","console","concat","message","body","getAsync","urls","getEntities","filteredUrls","includes","decodeURIComponent","responseContainer","createElement","appendChild","scannedUrls","indexOf","apiUrl","encodeURIComponent","setRequestHeader","DONE","responseDiv","startsWith","size","args","d","definition","o","get","prop","onReady","host","HostType","Outlook","style","display","onclick"],"sourceRoot":""}